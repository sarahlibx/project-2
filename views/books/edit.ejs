<!-- views/books/edit.ejs -->

<!DOCTYPE html>
<html lang="en">
  <%- include("../partials/_head.ejs") %>

  <body>
    <%- include('../partials/_navbar.ejs') %>

    <h1>Edit <%= book.title %></h1>

    <form
      action="/users/<%= user._id %>/books/<%= book._id %>?_method=PUT"
      method="POST"
    >
      <!-- Title -->
      <label for="title">Title:</label>
      <input 
        type="text" 
        name="title" 
        id="title" 
        value="<%= book.title %>" 
      />

      <!-- Author -->
      <label for="author">Author:</label>
      <input 
        type="text" 
        name="author" 
        id="author" 
        value="<%= book.author %>" 
      />

      <!-- Status -->
      <label for="status">Status:</label>
      <select id="status" name="status">
        <option value="Read" <%= book.status === 'Read' ? 'selected' : '' %>>Read</option>
        <option value="In Progress" <%= book.status === 'In Progress' ? 'selected' : '' %>>In Progress</option>
        <option value="Did Not Finish" <%= book.status === 'Did Not Finish' ? 'selected' : '' %>>Did Not Finish</option>
        <option value="To Be Read" <%= book.status === 'To Be Read' ? 'selected' : '' %>>To Be Read</option>
      </select>

      <!-- Review -->
      <label for="review">Review:</label>
      <textarea name="review" id="review"><%= book.review %></textarea>

      <!-- Rating -->
      <label for="rating">Rating:</label>
      <fieldset class="rating">
        <% 
          const ratingValue = (typeof book !== 'undefined' && book.rating) ? book.rating : null;
          for (let i = 1; i <=5; i++) { 
        %>
          <input
            type="radio"
            id="star<%= i %>"
            name="rating"
            value="<%= i %>"
            <%= ratingValue === i ? 'checked' : '' %>
          />
          <label for="star<%= i %>" title="<%= i %> stars">â˜…</label>
        <% } %>
      </fieldset>

      <!-- Submit -->
      <button type="submit">Update bookshelf</button>
    </form>

    <a href="/users/<%= user._id %>/books">Back</a>
  </body>

  <%- include("../partials/_footer.ejs") %>
</html>
